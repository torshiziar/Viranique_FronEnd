(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{233:function(e,t,a){"use strict";var n=a(165),l=a.n(n),c=a(139),i=a.n(c),r=a(166),o=a.n(r),s=a(0),u=a.n(s),m=a(180),d=a(146),f=a(147),p=a(21),v=[{value:"small",label:"سایز کوچگ 1*1"},{value:"medium",label:"سایز متوسط 1*2"},{value:"large",label:"سایز بزرگ 2*2"}],b=[{value:"5m",label:"5 دقیقه قبل"},{value:"30m",label:"30 دقیقه قبل"},{value:"1h",label:"1 ساعت قبل"},{value:"6h",label:"6 ساعت قبل"},{value:"1d",label:"1 روز قبل"}],E=[{value:1,label:"بدون اعشار"},{value:.1,label:"یک رقم اعشار"}];t.a=function(e){var t=e.onClose,a=e.onSave,n=e.isLoading,c=e.tile,r=Object(s.useState)(""),g=i()(r,2),h=g[0],y=g[1],N=Object(s.useState)([]),O=i()(N,2),w=O[0],x=O[1],j=Object(s.useState)([]),S=i()(j,2),k=S[0],C=S[1],D=Object(s.useState)([]),M=i()(D,2),A=M[0],T=M[1],F=Object(s.useState)(null),z=i()(F,2),R=z[0],L=z[1],P=Object(s.useState)(null),I=i()(P,2),X=I[0],Y=I[1],H=Object(s.useState)(null),_=i()(H,2),J=_[0],W=_[1],U=Object(s.useState)(null),q=i()(U,2),B=q[0],G=q[1],Z=Object(s.useState)(null),K=i()(Z,2),Q=K[0],V=K[1],$=Object(s.useState)(null),ee=i()($,2),te=ee[0],ae=ee[1],ne=Object(s.useState)(!1),le=i()(ne,2),ce=le[0],ie=le[1],re=Object(s.useState)(""),oe=i()(re,2),se=oe[0],ue=oe[1],me=Object(s.useState)(!1),de=i()(me,2),fe=de[0],pe=de[1];Object(s.useEffect)((function(){pe(!!(X&&J&&""!==h&&R&&B&&Q&&te))}),[X,J,h,R,B,Q,te]);var ve=Object(s.useRef)(null);Object(s.useEffect)((function(){be(),Ee()}),[]),Object(s.useEffect)((function(){var e;ue(ce?null===(e=ve.current)||void 0===e?void 0:e.getBoundingClientRect().height:0)}),[ce]),Object(s.useEffect)((function(){var e,t;null!=X&&null!==(e=X.item)&&void 0!==e&&e.units&&C((null==X||null===(t=X.item)||void 0===t?void 0:t.units).map((function(e){return{value:e,label:e}})))}),[X]);var be=function(){var e=l()(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.w)();case 2:(t=e.sent)&&x(t.map((function(e){return{value:null==e?void 0:e.id,label:null==e?void 0:e.title,item:e}})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=l()(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.x)();case 2:(t=e.sent)&&T(t.map((function(e){return{value:null==e?void 0:e.id,label:null==e?void 0:e.part_number,item:e}})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){c&&(y(c.title),L((function(){return v.find((function(e){return e.value===c.size}))})),ae((function(){return k.find((function(e){return e.value===c.unit}))})),V((function(){return E.find((function(e){return e.value===+c.precision}))})),G((function(){return b.find((function(e){return e.value===c.timeRange}))})),W((function(){return A.find((function(e){return e.value===c.sensor.id}))})),Y((function(){return w.find((function(e){return e.label===c.sensor_type.title}))})))}),[c,A,w]);return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"position-relative ".concat(p.isMobile?"card px-1 pt-3":"")},u.a.createElement("div",{className:"row row-gap-2 ".concat(p.isMobile?"px-2":"")},u.a.createElement("div",{className:"col-md-4 col-sm-12"},u.a.createElement("div",{className:"form-group "},u.a.createElement("label",{htmlFor:"selectedSensorType",className:"required"},"نوع سنسور"),u.a.createElement(m.a,{className:"autoCompeletSelect ",value:X,onChange:Y,options:w,mobileMode:!0,placeholder:"انتخاب کنید"}))),u.a.createElement("div",{className:"col-md-8 col-sm-12 ".concat(p.isMobile?"mt-2":"")},u.a.createElement("div",{className:"form-group "},u.a.createElement("label",{htmlFor:"selectedSensor",className:"required"},"انتخاب سنسور"),u.a.createElement(m.a,{className:"autoCompeletSelect ",value:J,onChange:W,options:A,mobileMode:!0,placeholder:"انتخاب کنید"})))),u.a.createElement("div",{className:"row ".concat(p.isMobile?"px-2":"pt-3")},u.a.createElement("div",{className:"col-md-8 col-sm-12 ".concat(p.isMobile?"mt-2":"")},u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{htmlFor:"title",className:"required"},"نام سنسور"),u.a.createElement("input",{className:"form-control px-3",type:"text",id:"title",name:"title",placeholder:"نام دلخواه برای سنسور انتخاب نمایید",value:h,onChange:function(e){return y(e.target.value)}}))),u.a.createElement("div",{className:"col-md-4 col-sm-12 ".concat(p.isMobile?"mt-2":"")},u.a.createElement("div",{className:"form-group "},u.a.createElement("label",{htmlFor:"provinceSelected",className:"required"},"نوع نمایش"),u.a.createElement(m.a,{className:"autoCompeletSelect ",value:R,onChange:L,options:v,mobileMode:!0,placeholder:"انتخاب کنید"})))),u.a.createElement("div",{className:"border-bottom ".concat(p.isMobile?"mx-2 mt-2":"mt-4"," ").concat(p.isMobile&&!ce?"":"mb-3")}),u.a.createElement("div",{className:"custom-collapse",style:{height:se}},u.a.createElement("div",{ref:ve},ce&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"row ".concat(p.isMobile?"px-2 pb-3":"")},u.a.createElement("div",{className:"col-md-4 col-sm-12 ".concat(p.isMobile?"mt-2":"mt-3")},u.a.createElement("div",{className:"form-group "},u.a.createElement("label",{htmlFor:"provinceSelected"},"بازه زمانی"),u.a.createElement(m.a,{className:"autoCompeletSelect ",value:B,onChange:G,options:b,mobileMode:!0,placeholder:"انتخاب کنید"}))),u.a.createElement("div",{className:"col-md-4 col-sm-12 ".concat(p.isMobile?"mt-2":"mt-3")},u.a.createElement("div",{className:"form-group "},u.a.createElement("label",{htmlFor:"selectedDiagramType"},"واحد اندازه گیری"),u.a.createElement(m.a,{className:"autoCompeletSelect ",value:te,onChange:ae,options:k,mobileMode:!0,placeholder:"انتخاب کنید"}))),u.a.createElement("div",{className:"col-md-4 col-sm-12 ".concat(p.isMobile?"mt-2":"mt-3")},u.a.createElement("div",{className:"form-group "},u.a.createElement("label",{htmlFor:"provinceSelected"},"دقت اعشار"),u.a.createElement(m.a,{className:"autoCompeletSelect ",value:Q,onChange:V,options:E,mobileMode:!0,placeholder:"انتخاب کنید"})))),!p.isMobile&&u.a.createElement("div",{className:"border-bottom mt-4 mb-3"})))),u.a.createElement("div",{className:"btn-collapse icon-24 icon-arrow-".concat(ce?"up":"down","-primary cursor-pointer"),onClick:function(){return ie((function(e){return!e}))},style:{bottom:"-13px"}})),u.a.createElement("div",{className:"row justify-content-end"},u.a.createElement("div",{className:"col-12 d-flex justify-content-end ".concat(p.isMobile?"mt-4":"mt-3")},u.a.createElement(f.a,{type:"submit",className:"d-flex button btn-primary-fill justify-content-center align-items-center px-5 ml-3 ".concat(p.isMobile?"width-65 mt-3":""," ").concat(fe?"":"disabled"),handler:function(e){!function(e){var n;n="large"===(null==R?void 0:R.value)?{x:0,y:0,h:2,w:2}:"medium"===(null==R?void 0:R.value)?{x:0,y:0,h:1,w:2}:{x:0,y:0,h:1,w:1};var l={title:h,size:null==R?void 0:R.value,unit:null==te?void 0:te.value,precision:null==Q?void 0:Q.value,timeRange:null==B?void 0:B.value,sensor:null==J?void 0:J.value,sensor_type:null==X?void 0:X.value,status:n};a&&a(l)&&t&&t()}()},isLoading:n},u.a.createElement("p",{className:"m-0"},"ذخیره")),u.a.createElement(f.a,{type:"submit",className:"d-flex button btn-primary-outline px-5 justify-content-center align-items-center ".concat(p.isMobile?"width-35 mt-3":""),handler:function(e){t?t():history.back()}},u.a.createElement("p",{className:"m-0"},"لغو")))))}},745:function(e,t,a){"use strict";a.r(t);var n=a(165),l=a.n(n),c=a(139),i=a.n(c),r=a(166),o=a.n(r),s=a(0),u=a.n(s),m=(a(192),a(33)),d=a(146),f=a(11),p=a.n(f),v=a(147),b=a(21),E=function(e){var t=e.onClose,a=e.data,n=e.handleActionTab,l=Object(s.useState)(""),c=i()(l,2),r=c[0],o=c[1];return Object(s.useEffect)((function(){a&&o(a.title)}),[a]),u.a.createElement("div",{className:"position-relative"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-md-12 col-sm-12"},u.a.createElement("div",{className:"form-group"},b.isMobile&&u.a.createElement("i",{className:"icon icon-20 icon-close btn-close",onClick:t}),u.a.createElement("label",{htmlFor:"title",className:"required ".concat(b.isMobile?"mb-3":"")},a?"ویرایش نام میزکار":"نام میزکار جدید"),u.a.createElement("input",{className:"form-control px-3",type:"text",id:"title",name:"title",placeholder:"یک نام برای میزکار خود انتخاب کنید",value:r,onChange:function(e){return o(e.target.value)}})))),u.a.createElement("div",{className:"row justify-content-end"},u.a.createElement("div",{className:"col-12 d-flex justify-content-end"},u.a.createElement(v.a,{type:"submit",className:"d-flex button btn-primary-fill justify-content-center align-items-center px-5 ".concat(b.isMobile&&!a?"w-100 mt-3":"width-65 ml-3"," ").concat(""===r?"disabled":""),handler:function(){n(r)}},u.a.createElement("p",{className:"m-0"},"ذخیره")),(!b.isMobile||b.isMobile&&a)&&u.a.createElement(v.a,{type:"submit",className:"d-flex button btn-primary-outline px-5 justify-content-center align-items-center width-35",handler:function(e){t&&t()}},u.a.createElement("p",{className:"m-0"},"لغو")))))},g=a(181),h=a.n(g),y=function(e){var t=e.item,a=e.onEdit,n=e.onDelete,l=e.onClick,c=e.selectedTab,r=Object(s.useState)(!1),o=i()(r,2),m=o[0],d=o[1],f=Object(s.useRef)(null),p=function(e){f.current&&!f.current.contains(e.target)&&d(!1)};return Object(s.useEffect)((function(){return document.addEventListener("click",p,!0),function(){document.removeEventListener("click",p,!0)}}),[]),u.a.createElement("div",{className:"position-relative ".concat(m?"dropdown-open":""," ").concat(c.id===t.id?"tab-active":"")},u.a.createElement("div",{className:"pr-4 py-2 border-left text-nowrap cursor-pointer"},u.a.createElement("span",{onClick:function(){return l(t)}},null==t?void 0:t.title),u.a.createElement("div",{className:"icon icon-18 icon-more-vertical mr-1",onClick:function(){return d((function(e){return!e}))}})),u.a.createElement("div",{className:"tile-dropdown position-absolute px-3 bg-white",ref:f},u.a.createElement("div",{onClick:function(){return a(t.id)},className:"d-flex tile-dropdown-item border-bottom border-muted py-3 align-items-center cursor-pointer"},u.a.createElement("div",{className:"icon icon-20 icon-edit"}),u.a.createElement("div",{className:"mr-2 text-nowrap"},"ویرایش نام میزکار")),u.a.createElement("div",{className:"d-flex tile-dropdown-item py-3 align-items-center cursor-pointer",onClick:function(){n(t.id),d(!1)}},u.a.createElement("div",{className:"icon icon-20 icon-delete"}),u.a.createElement("div",{className:"mr-2"},"حذف"))))},N=a(169);a(182);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}h.a.setAppElement("#root");var w,x,j,S,k,C,D,M,A=function(e){var t=e.tabs,a=e.onLoadTabs,n=e.onClick,l=e.selectedTab,c=Object(s.useState)(!1),r=i()(c,2),o=r[0],m=r[1],f=Object(s.useState)(null),g=i()(f,2),w=g[0],x=g[1],j=function(e){Object(d.z)(e).then((function(e){x(e),m(!0)})).catch((function(e){console.log(e)}))},S=function(e){Object(N.confirmAlert)({customUI:function(t){var n=t.onClose;return u.a.createElement("div",{className:"card card-box"},u.a.createElement("p",{className:"text-dark text-center ".concat(b.isMobile?"mt-3":"")},"آیا از حذف میزکار مطمئن هستید؟"),u.a.createElement("div",{className:"d-flex mt-4 justify-content-center"},u.a.createElement("button",{className:"button btn-primary-fill-outline py-2 px-3 col-6 ml-2 btn-primary-border text-primary bold",onClick:function(){!function(e){Object(d.i)(e).then((function(e){a()})).catch((function(e){console.log(e,": error")}))}(e),n()}},u.a.createElement("span",{className:"py-1 px-3"},"مطمئنم")),u.a.createElement("button",{className:"button btn-primary-fill py-2 px-4 col-6 mr-2 bold",onClick:n},u.a.createElement("span",{className:"py-1 px-3"},"لغو"))))},overlayClassName:"overlay-custom-confirm-modal"})};return u.a.createElement("section",{className:"card"},u.a.createElement("div",{className:"row align-items-center mx-0 p-3"},u.a.createElement(v.a,{className:"d-flex button btn-primary-fill submit justify-content-center align-items-center pl-3 pr-3",handler:function(){return m(!0)}},u.a.createElement("div",{className:"icon icon-24 icon-plus"}),u.a.createElement("div",{className:"mr-2 text-nowrap"},"میزکار جدید")),u.a.createElement("div",{className:"d-flex"},null==t?void 0:t.map((function(e,t){return u.a.createElement(y,{item:e,key:t,selectedTab:l,onEdit:j,onClick:n,onDelete:S})})))),u.a.createElement(h.a,{isOpen:o,contentLabel:"اضافه کردن تایل",className:"position-unset bg-white"},u.a.createElement(E,{onClose:function(){m(!1),x(null)},data:w,handleActionTab:function(e){if(w){var t=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){p()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},w);t.title=e,Object(d.T)(t,w.id).then((function(e){a(),m(!1),x(null)})).catch((function(e){return console.log(e)}))}else{var n={title:e,is_favorite:!1,order:1,field:1};Object(d.b)(n).then((function(e){a(),m(!1),x(null)})).catch((function(e){console.log(e,": err")}))}}})))},T=a(593),F=a(233),z=a(39),R=a.n(z),L=(a(534),a(32)),P=a(750),I=a(725),X=a(727),Y=a(535),H=a(477),_=a(160),J=a(142),W=a(199),U=a(604),q=a(726),B=a(209),G=function(e){return Object(s.useLayoutEffect)((function(){var t=Y.a.new(null==e?void 0:e.id,{useSafeResolution:!1});t.setThemes([B.a.new(t)]);var a=t.container.children.push(P.a.new(t,{panX:!1,panY:!1,startAngle:180,endAngle:360})),n=I.a.new(t,{innerRadius:-1,strokeOpacity:1,strokeWidth:6,strokeGradient:H.a.new(t,{rotation:0,stops:[{color:_.b("#1AD329")},{color:_.b("#F3E523")},{color:_.b("#FC7217")}]})});(w=a.xAxes.push(U.a.new(t,{maxDeviation:0,min:0,max:100,strictMinMax:!0,renderer:n}))).get("renderer").labels.template.setAll({opacity:0}),(x=w.makeDataItem({})).set("value",null==e?void 0:e.value);x.set("bullet",q.a.new(t,{sprite:X.a.new(t,{radius:J.d(90),topWidth:3,bottomWidth:10})}));return w.createAxisRange(x),x.get("grid").set("visible",!1),a.appear(1e3,100),function(){t.dispose()}}),[]),Object(s.useEffect)((function(){x.animate({key:"value",to:+(null==e?void 0:e.value),duration:800,easing:W.a.out(W.a.cubic)})}),[null==e?void 0:e.value,null==e?void 0:e.id]),u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"col-6 chart-holder mb-4",id:null==e?void 0:e.id}))},Z=a(721),K=a(605),Q=a(728),V=a(729),$=a(730),ee=a(749),te=a(278),ae=a(480),ne=a(481),le=function(e){return Object(s.useLayoutEffect)((function(){var t=Y.a.new(null==e?void 0:e.id,{useSafeResolution:!1});t.setThemes([B.a.new(t)]);var a=t.container.children.push(Z.a.new(t,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0}));a.set("cursor",K.a.new(t,{behavior:"none"})).lineY.set("visible",!1),(S=a.xAxes.push(Q.a.new(t,{maxDeviation:.5,baseInterval:{timeUnit:"minute",count:6},gridIntervals:[{timeUnit:"minute",count:6}],start:.9,dateFormats:{minute:"HH:mm"},renderer:V.a.new(t,{pan:"zoom"}),tooltip:te.a.new(t,{})}))).get("dateFormats").minute="HH:mm",S.get("periodChangeDateFormats").minute="HH:mm";var n=a.yAxes.push(U.a.new(t,{maxDeviation:1,renderer:$.a.new(t,{pan:"zoom"})}));(j=a.series.push(ee.a.new(t,{name:"Series",xAxis:S,yAxis:n,valueYField:"value",valueXField:"date",fill:_.b("#67b7dc"),stroke:_.b("#8bc8e5"),tooltip:te.a.new(t,{labelText:"{valueY}"})}))).fills.template.setAll({visible:!0,fillOpacity:.2}),j.bullets.push((function(){return ae.a.new(t,{locationY:0,sprite:ne.a.new(t,{radius:3,stroke:t.interfaceColors.get("background"),strokeWidth:1,fill:j.get("fill")})})})),j.appear(1e3),a.appear(1e3,100)}),[]),Object(s.useEffect)((function(){var t=[];null==e||e.value.map((function(e){var a={date:new Date(e.time).getTime(),value:+e.value};t.push(a)})),j.data.setAll(t)}),[e]),u.a.createElement("div",{className:"col-12 chart-holder graph",id:null==e?void 0:e.id})},ce=Object(m.b)((function(e){return{tilesData:e.tilesData}}),null)((function(e){var t=e.data,a=e.tilesData,n=Object(s.useState)(null),l=i()(n,2),c=l[0],r=l[1];return Object(s.useEffect)((function(){var e,n=a.find((function(e){return e.id===t.id}));r((null==n||null===(e=n.data)||void 0===e?void 0:e.length)>0?null==n?void 0:n.data:null)}),[a]),u.a.createElement("div",{className:"d-flex flex-wrap"},u.a.createElement("div",{className:("medium"===(null==t?void 0:t.size)||"large"===(null==t?void 0:t.size)?"col-6 ":"col-12 ")+"mt-4"},u.a.createElement("div",{className:"d-flex align-items-center"},u.a.createElement("div",{className:"icon icon-24 icon-Temperature"}),u.a.createElement("div",{className:"h3 mr-2 mb-0 font-30 bold"},u.a.createElement("span",{className:""},c?c[c.length-1].value:""),"C"===t.unit?u.a.createElement("span",{className:"h4"},"°c"):u.a.createElement("span",{className:"h4"},"°F"))),"medium"===t.size&&u.a.createElement("div",{className:"tile-description temperature"},u.a.createElement("div",null,u.a.createElement("span",{className:"circle good"}),u.a.createElement("span",null,"مناسب")),u.a.createElement("div",{className:"mr-2"},u.a.createElement("span",{className:"circle caution"}),u.a.createElement("span",null,"احتیاط")),u.a.createElement("div",{className:"mr-2"},u.a.createElement("span",{className:"circle danger"}),u.a.createElement("span",null,"خطر")))),("medium"===(null==t?void 0:t.size)||"large"===(null==t?void 0:t.size))&&c&&u.a.createElement(G,{id:"gauge-"+t.id,value:c[c.length-1].value}),"large"===(null==t?void 0:t.size)&&c?u.a.createElement(le,{id:"graph-"+t.id,value:c}):null)})),ie=a(731),re=a(732),oe=a(752),se=a(733),ue=function(e){return Object(s.useLayoutEffect)((function(){var t=Y.a.new(null==e?void 0:e.id,{useSafeResolution:!1});t.setThemes([B.a.new(t)]),(M=t.container.children.push(P.a.new(t,{panX:!1,panY:!1,wheelX:"panX",wheelY:"zoomX",innerRadius:J.d(82),startAngle:180,endAngle:360}))).set("cursor",ie.a.new(t,{behavior:"zoomX"})).lineY.set("visible",!1);var a=I.a.new(t,{minGridDistance:50});a.labels.template.setAll({radius:10}),a.grid.template.setAll({forceHidden:!0});var n=M.xAxes.push(U.a.new(t,{renderer:a,min:0,max:100,strictMinMax:!0,numberFormat:"#'%'",visible:!1,tooltip:te.a.new(t,{})})),l=re.a.new(t,{minGridDistance:20});l.labels.template.setAll({centerX:J.b,fontWeight:"500",fontSize:18,templateField:"columnSettings"}),l.grid.template.setAll({forceHidden:!0}),D=M.yAxes.push(se.a.new(t,{categoryField:"category",renderer:l})),(k=M.series.push(oe.a.new(t,{xAxis:n,yAxis:D,clustered:!1,valueXField:"full",categoryYField:"category",fill:t.interfaceColors.get("alternativeBackground")}))).columns.template.setAll({width:J.b,fillOpacity:.08,strokeOpacity:0,cornerRadius:20}),(C=M.series.push(oe.a.new(t,{xAxis:n,yAxis:D,clustered:!1,valueXField:"value",categoryYField:"category",colors:_.b("#1AD329")}))).columns.template.setAll({width:J.b,strokeOpacity:0,tooltipText:"{category}: {valueX}%",cornerRadius:20,templateField:"columnSettings"}),k.appear(1e3),C.appear(1e3),M.appear(1e3,100)}),[]),Object(s.useEffect)((function(){var t=[{category:"",value:+(null==e?void 0:e.value),full:100,columnSettings:{fill:M.get("colors").getIndex(3)}}];D.data.setAll(t),k.data.setAll(t),C.data.setAll(t)}),[e]),u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"col-6 position-relative chart-holder mb-4",id:null==e?void 0:e.id},u.a.createElement("span",{className:"number-gauge-humidity font-size-md"},null==e?void 0:e.value)))},me=Object(m.b)((function(e){return{tilesData:e.tilesData}}),null)((function(e){var t,a=e.data,n=e.tilesData,l=Object(s.useState)(null),c=i()(l,2),r=c[0],o=c[1];return L.a.subscribe((function(){var e,l,c;t=n.find((function(e){return e.id===(null==a?void 0:a.id)})),o((null===(e=t)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.length)>0?null===(c=t)||void 0===c?void 0:c.data:null)})),console.log(r),u.a.createElement("div",{className:"d-flex flex-wrap"},u.a.createElement("div",{className:"col-6 d-flex align-items-center position-relative"},u.a.createElement("div",{className:"d-flex align-items-center"},u.a.createElement("div",{className:"icon icon-24 icon-Humidity"}),u.a.createElement("div",{className:"h3 mr-2 mb-0 font-30 bold"},u.a.createElement("span",{className:""},r?r[r.length-1].value:""),u.a.createElement("span",{className:"h4"},"%"))),"medium"===(null==a?void 0:a.size)&&u.a.createElement("div",{className:"tile-description"},u.a.createElement("span",{className:"circle humidity"}),u.a.createElement("span",null,"رطوبت"))),("medium"===(null==a?void 0:a.size)||"large"===(null==a?void 0:a.size))&&r&&u.a.createElement(ue,{id:"gauge-"+(null==a?void 0:a.id),value:r[r.length-1].value}),"large"===(null==a?void 0:a.size)&&r?u.a.createElement(le,{id:"graph-"+a.id,value:r}):null)})),de=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()},fe=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.shouldPreventDefault,l=void 0===n||n,c=a.delay,r=void 0===c?300:c,o=Object(s.useState)(!1),u=i()(o,2),m=u[0],d=u[1],f=Object(s.useRef)(),p=Object(s.useRef)(),v=Object(s.useCallback)((function(t){l&&t.target&&(t.target.addEventListener("touchend",de,{passive:!1}),p.current=t.target),f.current=setTimeout((function(){e(t),d(!0)}),r)}),[e,r,l]),b=Object(s.useCallback)((function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f.current&&clearTimeout(f.current),a&&!m&&t(),d(!1),l&&p.current&&p.current.removeEventListener("touchend",de)}),[l,t,m]);return{onMouseDown:function(e){return v(e)},onTouchStart:function(e){return v(e)},onMouseUp:function(e){return b(e)},onMouseLeave:function(e){return b(e,!1)},onTouchEnd:function(e){return b(e)}}},pe={Temperature:ce,Humidity:me},ve=function(e){var t,a=e.data,n=e.onRemoveItem,c=e.onEdit,r=e.onDraggable,m=Object(s.useState)(!1),f=i()(m,2),p=f[0],v=f[1],E=Object(s.useRef)(null),g=Object(s.useRef)(null),h=Object(s.useState)(0),y=i()(h,2),O=(y[0],y[1],Object(s.useState)(0)),w=i()(O,2),x=(w[0],w[1],fe((function(){r()}),(function(){}),{shouldPreventDefault:!0,delay:500}));Object(s.useEffect)((function(){return document.addEventListener("mousedown",j),function(){document.removeEventListener("mousedown",j)}}),[]);var j=function(e){E.current&&!E.current.contains(e.target)&&g.current&&!g.current.contains(e.target)&&v(!1)},S=function(){var e=l()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&n(a.id),v(!1),e.next=4,Object(d.j)(null==a?void 0:a.id);case 4:e.sent;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=pe[null==a||null===(t=a.sensor_type)||void 0===t?void 0:t.name],C=function(e){e.stopPropagation(),v(!0)};return u.a.createElement("div",{className:"tile-card position-relative"},u.a.createElement("div",R()({className:"tile-header d-flex justify-content-between p-2 align-items-center border-bottom"},x),u.a.createElement("div",{className:"title-text h5",title:null==a?void 0:a.title},null==a?void 0:a.title),u.a.createElement("div",{className:"icon icon-24 icon-more-vertical cursor-pointer",ref:g,onMouseDown:function(e){return C(e)},onTouchStart:function(e){return C(e)}})),k&&u.a.createElement(k,{data:a}),u.a.createElement("div",{className:"tile-dropdown position-absolute px-2 bg-white "+(p?"selected":""),ref:E},u.a.createElement("div",{className:"d-flex tile-dropdown-item border-bottom mx-1 py-2 align-items-center",onClick:function(){r(),v(!1)}},u.a.createElement("div",{className:"icon icon-16 icon-move"}),u.a.createElement("div",{className:"mr-2"},"جابه جایی")),u.a.createElement("div",{className:"d-flex tile-dropdown-item border-bottom mx-1 py-2 align-items-center",onClick:function(){return c(null==a?void 0:a.id)}},u.a.createElement("div",{className:"icon icon-16 icon-edit"}),u.a.createElement("div",{className:"mr-2"},"ویرایش")),u.a.createElement("div",{className:"d-flex tile-dropdown-item mx-1 py-2 align-items-center",onClick:function(){Object(N.confirmAlert)({customUI:function(e){var t=e.onClose;return u.a.createElement("div",{className:"card card-box"},u.a.createElement("p",{className:"text-dark text-center ".concat(b.isMobile?"mt-3":"")},"آیا از حذف تایل مطمئن هستید؟"),u.a.createElement("div",{className:"d-flex mt-4 justify-content-center"},u.a.createElement("button",{className:"button btn-primary-fill-outline py-2 px-3 col-6 ml-2 btn-primary-border text-primary bold",onClick:function(){S(),t()}},u.a.createElement("span",{className:"py-1 px-3"},"مطمئنم")),u.a.createElement("button",{className:"button btn-primary-fill py-2 px-4 col-6 mr-2 bold",onClick:t},u.a.createElement("span",{className:"py-1 px-3"},"لغو"))))},overlayClassName:"overlay-custom-confirm-modal"})}},u.a.createElement("div",{className:"icon icon-16 icon-delete"}),u.a.createElement("div",{className:"mr-2"},"حذف"))))},be=a(31);function Ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(a),!0).forEach((function(t){p()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ee(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var he=Object(T.WidthProvider)(T.Responsive);h.a.setAppElement("#root");var ye,Ne=function(e){var t=e.tiles,a=e.selectedTab,n=e.onLayoutChange,c=e.onRemoveItem,r=e.onloadTiles,m=Object(s.useState)(!1),f=i()(m,2),p=f[0],E=f[1],g=Object(s.useState)(null),y=i()(g,2),N=y[0],O=y[1],w=Object(s.useState)(!1),x=i()(w,2),j=x[0],S=x[1],k=Object(s.useState)(!1),C=i()(k,2),D=C[0],M=C[1],A=Object(s.useState)(!1),T=i()(A,2),z=T[0],R=T[1],L=Object(s.useState)(!1),P=i()(L,2),I=P[0],X=P[1],Y=function(){var e=l()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S(!0),n=null,!N){e.next=8;break}return e.next=5,Object(d.U)(t,N.id);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Object(d.c)(t,a.id);case 10:n=e.sent;case 11:S(!1),n&&(E(!1),O(null),r(),alert.show("باموفقیت اضافه گردید",{type:"success"}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e){Object(d.B)(e).then((function(e){O(e),E(!0)})).catch((function(e){return console.log(e)}))},_=function(e){switch(null==e?void 0:e.size){case"small":return{w:1,h:1};case"medium":return{w:2,h:1};case"large":return{w:2,h:2};default:return{w:1,h:1}}},J=function(){M((function(e){return!e}))},W=function(e){Object.keys(e).map((function(t,a){e[t]*=1}))},U=function(e){console.log("removing",e),c&&c(e)};return u.a.createElement(u.a.Fragment,null,u.a.createElement("section",{className:"".concat(D?"card":"")},u.a.createElement(he,{className:"layout rtl",rowHeight:160,width:860,layouts:z,onLayoutChange:function(e,l){n&&n(t),R(l),localStorage.setItem("position-".concat(a.id),JSON.stringify(l))},isDraggable:D,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2}},t.length&&function(){for(var e=[],n=0,l=function(l){var c=t[l],i=_(c),r=(ge({x:1===(null==i?void 0:i.w)?4-n%5:3-n%5,y:Math.round(n/5)},i),void 0);if(localStorage.getItem("position-".concat(a.id))){var o=JSON.parse(localStorage.getItem("position-".concat(a.id)));(r=Object.values(o)[1].find((function(e){return parseInt(e.i)===c.id})))||(r=ge(ge({},r=t[l].status),{},{i:c.id}))}else r=ge(ge({},r=t[l].status),{},{i:c.id});W(r),n=1===(null==i?void 0:i.w)?n+1:n+2,e.push(u.a.createElement("section",{className:"tile-item ".concat("medium"===c.size?"tile-item-medium":"tile-item-small"),key:c.id,"data-grid":r},u.a.createElement(ve,{data:c,key:c.id,onRemoveItem:U,onEdit:H,onDraggable:J})))},c=0;c<t.length;c++)l(c);return e}()),D&&u.a.createElement("div",{className:"d-flex justify-content-end mt-3 px-2 pb-4"},u.a.createElement(v.a,{className:"d-flex button btn-primary-fill height-auto py-1 px-4 justify-content-center align-items-center ml-3",handler:function(){return M(!1)}},u.a.createElement("span",null,"ذخیره تغییرات")),u.a.createElement(v.a,{className:"d-flex button btn-primary-outline btn-primary-border height-auto px-4 py-1 justify-content-center ml-1 align-items-center",handler:function(){localStorage.setItem("position-".concat(a.id),JSON.stringify(I)),R(I),M(!1)}},u.a.createElement("span",{className:""},"لغو تغییرات"))),!D&&(b.isMobile?u.a.createElement(be.b,{className:"tile-item  add-tile d-flex align-items-center justify-content-center",to:{pathname:"/Panel/Dashboard/AddNewTile",state:{selectedTab:a.id}}},u.a.createElement("i",{className:"icon icon-48 icon-plus-primary"})):u.a.createElement("section",{className:"tile-item  add-tile d-flex align-items-center justify-content-center",onClick:function(){return E(!0)}},u.a.createElement("i",{className:"icon icon-48 icon-plus-primary"})))),D?null:u.a.createElement(v.a,{className:"d-flex button btn-primary-fill mt-3 height-auto p-2 justify-content-center align-items-center",handler:function(){X(z),M(!0)},title:"جابه جایی تایل ها"},u.a.createElement("span",{className:"p-1"},u.a.createElement("i",{className:"icon icon-22 icon-click-move"}))),u.a.createElement(h.a,{isOpen:p,contentLabel:"اضافه کردن تایل",className:"position-unset bg-white"},u.a.createElement(F.a,{onSave:function(e){Y(e)},onClose:function(){E(!1),O(null)},isLoading:j,tile:N})))},Oe=(a(719),a(613)),we=a(8);t.default=Object(m.b)(null,(function(e){return{setTilesData:function(t){return e({type:we.h,payload:t})},setTileData:function(t){return e({type:we.i,payload:t})},addTile:function(t){return e({type:we.b,payload:t})}}}))((function(e){var t=e.setTilesData,a=e.setTileData,n=e.addTile,c=Object(s.useState)(!0),r=i()(c,2),m=(r[0],r[1]),f=Object(s.useState)([]),p=i()(f,2),v=p[0],b=p[1],E=Object(s.useState)({}),g=i()(E,2),h=g[0],y=g[1],N=Object(s.useState)([]),O=i()(N,2),w=O[0],x=O[1];Object(s.useEffect)((function(){return j(),ye=new WebSocket("ws://test.angizehco.com/ws/dashboard/".concat(localStorage.getItem("token"),"/")),console.log(ye),ye.onopen=function(){ye.addEventListener("message",(function(e){var l=JSON.parse(e.data);switch(console.log(l),l.type){case"get_tiles":t(l.response);break;case"get_data":a(l.response);break;case"get_tile":n(l.response)}}))},function(){clearTimeout(void 0),ye.close()}}),[]),Object(s.useEffect)((function(){null!=h&&h.id&&(S(),1===ye.readyState&&ye.send(JSON.stringify({tab_id:null==h?void 0:h.id})))}),[h]),Object(s.useEffect)((function(){w.map((function(e){Object(d.C)(e.id).then((function(e){a(e)})).catch((function(e){return console.log(e)}))}))}),[w]);var j=function(){var e=l()(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,Object(d.A)();case 3:t=e.sent,m(!1),t&&(b(t),y(t[0]));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=l()(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,Object(d.D)(null==h?void 0:h.id);case 3:a=e.sent,m(!1),a&&(x(a),t(a));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return u.a.createElement("div",{className:""},u.a.createElement(A,{tabs:v,onLoadTabs:j,onClick:y,selectedTab:h}),u.a.createElement("div",{className:"row mt-3"},u.a.createElement("div",{className:"col-md-7"},u.a.createElement(Ne,{tiles:w,selectedTab:h,useCSSTransforms:!0,onRemoveItem:function(e){console.log("onRemoveItem",e),x(Object(Oe.reject)(w,{id:e}))},onLayoutChange:function(e){},onloadTiles:S})),u.a.createElement("div",{className:"col-md-5"})))}))}}]);