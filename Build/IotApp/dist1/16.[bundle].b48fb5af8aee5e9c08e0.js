(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{802:function(e,t,a){var n=a(291),r=a(803);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};n(r,o);e.exports=r.locals||{}},803:function(e,t,a){"use strict";a.r(t);var n=a(49),r=a.n(n)()(!1);r.push([e.i,".wrap_grafana_fram{border-radius:12px;box-shadow:0px 1px 8px rgba(56,125,248,.25)}.wrap_grafana_fram .header_grafana_fram{height:40px;border-radius:12px 12px 0px 0px;position:relative;background-color:#e6e6e6;cursor:all-scroll;display:flex;flex-direction:row}.wrap_grafana_fram .header_grafana_fram div{position:absolute;top:5px}.wrap_grafana_fram .header_grafana_fram div:first-child{right:10px}.wrap_grafana_fram .header_grafana_fram div:last-child{right:45px}.wrap_grafana_fram .grafana_fram{padding:4px 20px 47px 20px;width:100%;height:100%;margin:5px;cursor:move;user-select:none;border:0px}.disable{pointer-events:none;opacity:.5}",""]),t.default=r},837:function(e,t,a){"use strict";a.r(t);var n=a(357),r=a.n(n),o=a(325),l=a.n(o),c=a(358),s=a.n(c),i=a(1),m=a.n(i),d=a(353),u=a.n(d),p=a(348),f=a(406),g=a(328),h=a(446),v=a(21),b=a(332),x=a(800),_=a.n(x),y=a(398),S=a(648),E=a(645),w=a(649),N=a(644),I=a(650),M=a(651),j=a(444),O=function(e){var t=e.data,a=e.sensors,n=e.unit,r=Object(i.useState)([]),o=l()(r,2),c=o[0],s=o[1],d=Object(i.useState)([]),p=l()(d,2),f=(p[0],p[1]),g=Object(i.useState)([]),h=l()(g,2),v=(h[0],h[1]),b=Object(i.useState)([]),x=l()(b,2),O=x[0],Y=x[1],k={title:{text:"Highcharts with a shared tooltip formatter"},xAxis:{categories:c},tooltip:{formatter:function(){return this.points.reduce((function(e,t){return"hi"}),"</b>")},shared:!0},series:[O]};return Object(i.useEffect)((function(){if(t&&t.length>0){var e=[],a=[],n=[],r=[],o=[],l=[],c=[];t.map((function(t,s){Object.values(t).map((function(t){c=[],r=[],o=[],l=[],t.map((function(e){c.push(u()(e.time).format("jYYYY/jMM/jDD HH:mm")),r.push(Math.ceil(10*e.mean_value)/10),l.push(e.min),o.push(e.max)})),e.push(r),a.push(l),n.push(o)}))})),f(a),v(n),s(c),Y(e)}}),[t]),m.a.createElement("div",null,m.a.createElement(y.a,{Highcharts:_.a},m.a.createElement(S.a,{mapNavigation:{enableMouseWheelZoom:!0},plotOptions:k},m.a.createElement(E.a,{zooming:{type:"x"}}),m.a.createElement(w.a,{valueSuffix:" ".concat(n),pointFormat:"{point.y}",shared:!0}),m.a.createElement(N.a,{layout:"horizontal",align:"top",verticalAlign:"left"}),m.a.createElement(I.a,{categories:c,labels:{formatter:function(e){var t=e.value.split(" ");return'\n                            <div style="display: flex; flex-direction: column">\n                                <div style="color: #585858;">'.concat(t[0],'</div>\n                                <div style="color: #283972;">').concat(t[1],"</div>\n                            </div>\n                        ")}}}),m.a.createElement(M.a,null,O.length>0&&O.map((function(e,t){var n;return m.a.createElement(j.a,{key:t,name:null===(n=a[t])||void 0===n?void 0:n.label,data:e,marker:{fillColor:"white",lineWidth:2,lineColor:_.a.getOptions().colors[0]}})}))))))},Y=a(349),k=a(388),D=a.n(k),C=(a(802),a(14)),A=function(e){var t=e.start_time_,a=e.stop_time_,n=e.panelId,r=e.uid,o=e.closeChart,l=e.counter,c=e.editChart,s=e.sensor_type_,i=e.selectedDevice_,d=e.Name,u=e._measurement,p=e.gateway,f=(e.url,e.disableEditButton,function(e){o(l)}),g=function(e){e.target.parentElement.parentElement.parentElement.parentElement.parentElement.classList.contains("editable")?alert.show("".concat(h("text.Completependingapplicationsfirst")),{type:"error"}):(console.log("e"),e.target.parentElement.parentElement.classList.add("bg-warning"),e.target.parentElement.parentElement.classList.add("disable"),e.target.parentElement.parentElement.parentElement.parentElement.parentElement.classList.add("editable"),c(n,s,i,d,l,p,u,r))},h=Object(C.b)().t;return v.isMobile?m.a.createElement("div",{id:"item".concat(l),key:"item".concat(l),className:"m-2 border",style:{resize:"both",overflow:"hidden",width:"-webkit-fill-available",height:"500px",borderRadius:"12px 12px 0px 0px"}},m.a.createElement("div",{className:"wrap_grafana_fram "},m.a.createElement("div",{className:"header_grafana_fram"},m.a.createElement("div",{"data-toggle":"tooltip","data-placement":"top",title:h("text.chartdelete"),className:""},m.a.createElement("i",{className:"icon icon-28 icon-close-2 cursor-pointer",onClick:f})),m.a.createElement("div",{"data-toggle":"tooltip","data-placement":"top",title:h("text.Addchart")},m.a.createElement("i",{className:"icon icon-28 icon-plus-primary-2 cursor-pointer",onClick:function(e){return g(e)}}))),m.a.createElement("iframe",{src:"https://grafana.iotstream.ir/d-solo/".concat(r,"/").concat(i,"?orgId=1&from=").concat(t,"&to=").concat(a,"&panelId=").concat(n,"&kiosk=1&theme=light"),className:"grafana_fram"}))):m.a.createElement(D.a,{onDrag:function(e,t){console.log(t.y,t.x)},handle:".header_grafana_fram",bounds:"parent",onStop:function(e,t){console.log(t.y,t.x)}},m.a.createElement("div",{id:"item".concat(l),key:"item".concat(l),className:"m-2 border",style:{resize:"both",overflow:"hidden",width:"-webkit-fill-available",height:"500px",borderRadius:"12px 12px 0px 0px"}},m.a.createElement("div",{className:"wrap_grafana_fram "},m.a.createElement("div",{className:"header_grafana_fram"},m.a.createElement("div",{"data-toggle":"tooltip","data-placement":"top",title:h("text.chartdelete"),className:""},m.a.createElement("i",{className:"icon icon-28 icon-close-2 cursor-pointer",onClick:f})),m.a.createElement("div",{"data-toggle":"tooltip","data-placement":"top",title:h("text.Addchart")},m.a.createElement("i",{className:"icon icon-28 icon-plus-primary-2 cursor-pointer",onClick:function(e){return g(e)}}))),m.a.createElement("iframe",{src:"https://grafana.iotstream.ir/d-solo/".concat(r,"/").concat(i,"?orgId=1&from=").concat(t,"&to=").concat(a,"&panelId=").concat(n,"&kiosk=1&theme=light"),className:"grafana_fram"}))))},L=a(455),V=a.n(L),W=function(e,t){var a;return e.map((function(e,n){e.props.counter==t.counter&&(a=n)})),a},H=a(410),T=a.n(H),J=(a(409),{calendarContainer:"calendarContainer",dayPickerContainer:"dayPickerContainer",monthsList:"monthsList",daysOfWeek:"daysOfWeek",dayWrapper:"dayWrapper",currentMonth:"currentMonth",selected:"selected",heading:"heading",prev:"prev",next:"next",title:"title"}),F=u()(),z=u()().utcOffset(0);z.set({hour:0,minute:0,second:1,millisecond:0});t.default=function(){var e=Object(C.b)().t,t=Object(i.useState)([]),a=l()(t,2),n=a[0],o=a[1],c=Object(i.useState)(null),d=l()(c,2),x=d[0],_=d[1],y=Object(i.useState)(null),S=l()(y,2),E=S[0],w=S[1],N=Object(i.useState)([]),I=l()(N,2),M=I[0],j=I[1],k=Object(i.useState)([]),D=l()(k,2),L=D[0],H=D[1],P=Object(i.useState)(z),q=l()(P,2),R=q[0],B=q[1],G=Object(i.useState)(new Date),Z=l()(G,2),Q=Z[0],U=Z[1],X=Object(i.useState)(u()()),K=l()(X,2),$=K[0],ee=K[1],te=Object(i.useState)(new Date),ae=l()(te,2),ne=ae[0],re=ae[1],oe=Object(i.useState)(null),le=l()(oe,2),ce=le[0],se=le[1],ie=Object(i.useState)(!1),me=l()(ie,2),de=me[0],ue=me[1],pe=Object(i.useState)(!1),fe=l()(pe,2),ge=fe[0],he=fe[1],ve=Object(i.useState)(null),be=l()(ve,2),xe=be[0],_e=be[1],ye=Object(i.useState)(0),Se=l()(ye,2),Ee=Se[0],we=Se[1],Ne=Object(i.useState)(1001),Ie=l()(Ne,2),Me=Ie[0],je=Ie[1],Oe=Object(i.useState)([]),Ye=l()(Oe,2),ke=Ye[0],De=Ye[1],Ce=Object(i.useState)([null]),Ae=l()(Ce,2),Le=Ae[0],Ve=Ae[1],We=Object(i.useState)(!1),He=l()(We,2),Te=He[0],Je=He[1],Fe=Object(i.useState)("text.show"),ze=l()(Fe,2),Pe=ze[0],qe=ze[1],Re=Object(i.useState)(null),Be=l()(Re,2),Ge=Be[0],Ze=Be[1];Object(i.useEffect)((function(){for(var e=0;e<=20;e++)localStorage.removeItem("grafana".concat(e))}),[]),Object(i.useEffect)((function(){if(0==ke.length)for(var e=0;e<=20;e++)localStorage.removeItem("grafana".concat(e))}),[ke]),Object(i.useEffect)((function(){Qe(),Ve([{type_sensor:"Air Humidity",select_sensor:"VMN-A01-01-0003",panelId:3,url:"http://185.252.28.42:3000/d-solo/pWV4-Y7Ik/vnm-a01-01-003?orgId=1"},{type_sensor:"Air Temperature",select_sensor:"VMN-A01-01-0003",panelId:7,url:"http://185.252.28.42:3000/d-solo/pWV4-Y7Ik/vnm-a01-01-003?orgId=1"},{type_sensor:"Light",select_sensor:"VMN-A01-01-0003",panelId:4,url:"http://185.252.28.42:3000/d-solo/pWV4-Y7Ik/vnm-a01-01-003?orgId=1"},{type_sensor:"Soil Moisture",select_sensor:"VMN-A01-01-0003",panelId:5,url:"http://185.252.28.42:3000/d-solo/pWV4-Y7Ik/vnm-a01-01-003?orgId=1"},{type_sensor:"Soil Temperature",select_sensor:"VMN-A01-01-0003",panelId:6,url:"http://185.252.28.42:3000/d-solo/pWV4-Y7Ik/vnm-a01-01-003?orgId=1"},{type_sensor:"CO2",select_sensor:"VMN-A01-01-0003",panelId:2,url:"http://185.252.28.42:3000/d-solo/pWV4-Y7Ik/vnm-a01-01-003?orgId=1"},{type_sensor:"Leaf Moisture",select_sensor:"VMN-A01-01-0006",panelId:2,url:"http://185.252.28.42:3000/d-solo/SXv5Y0nSk/vnm-a01-01-0006?orgId=1"},{type_sensor:"Leaf Temperature",select_sensor:"VMN-A01-01-0006",panelId:3,url:"http://185.252.28.42:3000/d-solo/SXv5Y0nSk/vnm-a01-01-0006?orgId=1"},{type_sensor:"WaterPH",select_sensor:"VMN-A01-01-0012",panelId:5,url:"http://185.252.28.42:3000/d-solo/QDWr8ZHSk/vmn-a01-01-0012?orgId=1"},{type_sensor:"WaterTemperature",select_sensor:"VMN-A01-01-0012",panelId:6,url:"http://185.252.28.42:3000/d-solo/QDWr8ZHSk/vmn-a01-01-0012?orgId=1"},{type_sensor:"Air Temperature",select_sensor:"VMN-A01-01-0013",panelId:6,url:"http://185.252.28.42:3000/d-solo/QDWr8ZHSk/vmn-a01-01-0012?orgId=1"},{type_sensor:"Air Humidity",select_sensor:"VMN-A01-01-0013",panelId:6,url:"http://185.252.28.42:3000/d-solo/QDWr8ZHSk/vmn-a01-01-0012?orgId=1"},{type_sensor:"Light",select_sensor:"VMN-A01-01-0013",panelId:6,url:"http://185.252.28.42:3000/d-solo/QDWr8ZHSk/vmn-a01-01-0012?orgId=1"}])}),[]),Object(i.useEffect)((function(){j([]),H([]),null!=x&&x.value&&Object(g.H)(null==x?void 0:x.value).then((function(e){var t,a;(j(Object(Y.e)(e)),null!==(t=e[0].type)&&void 0!==t&&t.default_unit)&&_e(null===(a=e[0].type)||void 0===a?void 0:a.default_unit)})).catch((function(e){return console.log(e)}))}),[x]),Object(i.useEffect)((function(){null!==x&&(null==L?void 0:L.length)>0||1==Ge?he(!0):he(!1)}),[x,L,Ge]);var Qe=function(){Object(g.z)().then((function(e){o(Ue(e))})).catch((function(e){console.log(e)}))},Ue=function(e){return e.map((function(e){return{value:e.id,label:e.title}}))};var Xe=function(){var e=r()(s.a.mark((function e(){var t,a,n,r,o,l,c,i,d,p,f,h,v,b,_,y,S,w,N,I;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},ue(!0),l={sensor_type:x.value,sensor_list:L.map((function(e){return e.value})),start_time:R.format("YYYY-MM-DD HH:mm:ss"),stop_time:$.format("YYYY-MM-DD HH:mm:ss")},e.next=5,Object(g.v)(l).then((function(e){se(e.data.responses),o={_measurement:e.data._measurement,gateway:e.data.gateway},ue(!1)})).catch((function(e){console.log(e),ue(!1)}));case 5:return i=new Date($.format("YYYY-MM-DD 12:00:00")).getTime(),"fa"==localStorage.getItem("i18nextLng")?(c=new Date(R.format("YYYY-MM-DD 00:00:00")).getTime(),i=new Date($.format("YYYY-MM-DD 12:00:00")).getTime()):(c=new Date(u()(Q).locale("en").format("YYYY-MM-DD 00:00:00")).getTime(),i=new Date(u()(ne).locale("en").format("YYYY-MM-DD 12:00:00")).getTime()),d=x.label,p=L.map((function(e){return e.item.part_number})),f=L.map((function(e){return e.item.title})),h=[{}],E&&0!==(null==E?void 0:E.value)&&(_=parseInt(E.label),y=Math.abs(i-c),S=Math.ceil(y/864e5),console.log("diffDays:",S,S*_/100),console.log("jjjj",Math.ceil(S*_/100)),console.log("stop_time_:",i),v=Math.ceil(S*_/100),b=i+3*v*60*60*1e3),w=Le.find((function(e){return e.type_sensor==d&&e.select_sensor==p})),console.log(E,"selectedPrediction"),null==Ge?h=[{title:"".concat(p.toString()),type:"".concat(o._measurement),gateway:"".concat(o.gateway),name:encodeURIComponent(f.toString()),prediction:null!==E&&0!==(null==E?void 0:E.value),step:null!==E&&0!==(null==E?void 0:E.value)?v:null}]:(I=localStorage.getItem("grafana".concat(Ge.counter)),h=JSON.parse(I).concat({title:p.toString(),type:"".concat(o._measurement),gateway:"".concat(o.gateway),name:encodeURIComponent(f.toString())})),e.next=17,(s=h,V.a.get("https://angizeh.iotstream.ir/dashboard/get_panel/",{headers:{data:JSON.stringify(s),"API-Key":"Bearer glsa_ezsnxe4VvYfrblwtlzcE04tFIdMJ187k_d3f31b19"}}).then((function(e){return e})).catch((function(e){return Promise.reject(e)}))).then((function(e){N=e.data})).catch((function(e){console.log(e)}));case 17:w?(null==Ge?(De(ke.concat(m.a.createElement(A,{start_time_:c,stop_time_:b||i,panelId:null===(t=N)||void 0===t?void 0:t.panelId,uid:null===(a=N)||void 0===a?void 0:a.uid,closeChart:Ke,counter:Ee,key:Ee,sensor_type_:d,selectedDevice_:p,editChart:$e,gateway:o.gateway,_measurement:o._measurement,Name:f}))),we(Ee+1)):(ke[W(ke,Ge)]=m.a.createElement(A,{start_time_:c,stop_time_:b||i,panelId:null===(n=N)||void 0===n?void 0:n.panelId,uid:null===(r=N)||void 0===r?void 0:r.uid,closeChart:Ke,counter:Ge.counter,key:Me,sensor_type_:d,selectedDevice_:p,editChart:$e,gateway:o.gateway,_measurement:o._measurement,Name:f}),je(Me+1),De(ke)),Je(!1)):Je(!0),qe("text.show"),Ze(null),document.querySelector(".wrapChartGrafana").classList.remove("editable");case 21:case"end":return e.stop()}var s}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function(e){De((function(t){return t.filter((function(t,a){return t.props.counter!=e}))}))},$e=function(e,t,a,n,r,o,l,c){var s=localStorage.getItem("grafana".concat(r));s?(s=JSON.parse(s).concat({type:l,gateway:o,title:a.toString(),name:encodeURIComponent(n.toString())}),localStorage.setItem("grafana".concat(r),JSON.stringify(s))):localStorage.setItem("grafana".concat(r),JSON.stringify([{type:l,gateway:o,title:a.toString(),name:encodeURIComponent(n.toString())}])),qe("text.add"),Ze({panelId:e,sensor_type_:t,selectedDevice_:a,counter:r,uid:c})};return m.a.createElement("div",{className:"overflow-auto height-user-custom px-30px mx--15px mt--15px pt-15px"},m.a.createElement("section",{className:"row card card-box"},m.a.createElement("div",{className:"col-12 pt-4 pb-32px px-32px"},m.a.createElement("div",{className:"row ".concat(v.isMobile?"flex-column":"align-items-end")},m.a.createElement("div",{className:"col-lg-12 col-md-12 col-xl-6 col-sm-12 d-flex ".concat(v.isMobile?"flex-column":"")},m.a.createElement("div",{className:"historyDateSelectBox form-group flex-grow-1 ".concat(v.isMobile?"":"ml-4 mb-0")},m.a.createElement("label",{htmlFor:"provinceSelected",className:"required mb-1"},e("text.sensortype")),m.a.createElement(p.a,{className:"autoCompeletSelect ",value:x,onChange:_,options:n,mobileMode:!0,placeholder:e("text.Select")})),m.a.createElement("div",{className:"form-group flex-grow-1 ".concat(v.isMobile?"mt-1":"mb-0")},m.a.createElement("label",{htmlFor:"parameter",className:"required mb-1"},e("text.Sensorselection")),m.a.createElement(h.a,{options:M,value:L,hasSelectAll:!1,disableSearch:!0,ArrowRenderer:function(e){e.expanded;return m.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},m.a.createElement("path",{d:"M6 9L12 15L18 9",stroke:"#646464",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))},onChange:H,labelledBy:e("text.Select"),overrideStrings:{noOptions:"".concat(e("text.Thereisnodata")),search:"".concat(e("text.search")),selectSomeItems:"".concat(e("text.Select")),allItemsAreSelected:"".concat(e("text.Allitemsselected"))}}))),m.a.createElement("div",{className:"col-lg-12 col-md-12 col-xl-2 col-sm-12 d-flex ".concat(v.isMobile?"flex-column":"")},m.a.createElement("div",{className:"historyDateSelectBox form-group flex-grow-1 ".concat(v.isMobile?"":"ml-4 mb-0")},m.a.createElement("label",{htmlFor:"provinceSelected",className:" mb-1"},e("text.prediction")),m.a.createElement(p.a,{className:"autoCompeletSelect ",value:E,onChange:w,options:[{value:0,label:"بدون پیش بینی"},{value:1,label:"1%"},{value:2,label:"2%"},{value:3,label:"3%"},{value:4,label:"4%"},{value:5,label:"5%"},{value:6,label:"6%"},{value:7,label:"7%"},{value:8,label:"8%"},{value:9,label:"9%"},{value:10,label:"10%"}],mobileMode:!0,placeholder:e("text.Select")}))),m.a.createElement("div",{className:"col-lg-12 col-md-12 col-xl-4  col-sm-12 d-flex align-items-end ".concat(v.isMobile?"flex-wrap":"")},m.a.createElement("div",{className:"d-flex w-100 ".concat(v.isMobile?"col-12 mt-1 p-0":"")},m.a.createElement("div",{className:"form-group w-50 ".concat(v.isMobile?"ml-2":"ml-3 mb-0")},m.a.createElement("label",{htmlFor:"dateFrom",className:"ml-3 mb-1"},e("text.startdate")),"fa"==localStorage.getItem("i18nextLng")?m.a.createElement(f.DatePicker,{calendarStyles:J,inputFormat:"jYYYY/jM/jD",className:"report-calendar-Container form-control p-date-picker",value:R,closeOnSelect:!0,max:F,beforeShowDay:!0,onChange:function(e){B(e)}}):m.a.createElement(T.a,{selected:Q,onChange:function(e){return U(e)},className:"report-calendar-Container form-control p-date-picker"}),m.a.createElement("i",{className:"icon icon-24 icon-calendar  left-12px"})),m.a.createElement("div",{className:"form-group w-50 ".concat(v.isMobile?"mr-2":"ml-32px mb-0")},m.a.createElement("label",{htmlFor:"dateTo",className:"ml-3 mb-1"},e("text.enddate")),"fa"==localStorage.getItem("i18nextLng")?m.a.createElement(f.DatePicker,{calendarStyles:J,inputFormat:"jYYYY/jM/jD",className:"report-calendar-Container form-control p-date-picker",value:$,closeOnSelect:!0,max:F,beforeShowDay:!1,onChange:function(e){ee(e)}}):m.a.createElement(T.a,{selected:ne,onChange:function(e){return re(e)},className:"report-calendar-Container form-control p-date-picker"}),m.a.createElement("i",{className:"icon icon-24 icon-calendar left-12px"}))),m.a.createElement(b.a,{className:"button btn-primary-fill d-flex align-items-center justify-content-center py-2 px-xl-5 px-lg-4 px-4 mr-auto ".concat(ge?"":"disabled"),handler:Xe,isLoading:de},e(Pe)),Ge&&m.a.createElement(b.a,{className:"button btn-primary-fill d-flex align-items-center justify-content-center py-2 px-xl-5 px-lg-4 px-4 mx-2 ".concat(ge?"":"disabled"),handler:function(){for(var e=0;e<document.querySelector(".wrapChartGrafana").childNodes.length;e++)console.log(document.querySelector(".wrapChartGrafana").childNodes[e].childNodes[0].childNodes[0].classList.remove("bg-warning")),document.querySelector(".wrapChartGrafana").childNodes[e].childNodes[0].childNodes[0].classList.remove("disable");document.querySelector(".wrapChartGrafana").classList.remove("editable"),console.log(JSON.parse(localStorage.getItem("grafana".concat(Ge.counter))));var t=JSON.parse(localStorage.getItem("grafana".concat(Ge.counter)));console.log(t.pop()),localStorage.setItem("grafana".concat(Ge.counter),JSON.stringify(t)),Ze(null),qe("text.show")},isLoading:de},e("text.cancel")))))),Te?m.a.createElement("section",{className:"row card mt-3"},m.a.createElement("div",{className:"col-12"},ce&&m.a.createElement(O,{data:ce,sensors:L,unit:xe||""}))):m.a.createElement("section",{className:"row mt-3 wrapChartGrafana",style:{position:"relative"}},ke))}}}]);